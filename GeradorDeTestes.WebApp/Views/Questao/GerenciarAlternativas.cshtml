﻿
@model GerenciarAlternativasViewModel

@{
    ViewBag.Titulo = "Gestão de Alternativas";
}

<div class="card rounded-4 border-0">
    <div class="card-body p-md-4">
        <div class="d-flex justify-content-between mb-4">
            <h3>@Model.Questao.NomeMateria</h3> 
            <h3>@Model.Questao.NomeDisciplina</h3>
        </div>

        <h3>@Model.Questao.Enunciado</h3>

        @if (ViewData.ModelState["ConflitoAlternativas"]?.Errors.Count > 0)
        {
            <div class="alert alert-danger alert-dismissible fade show my-3" role="alert">
                @ViewData.ModelState["ConflitoAlternativas"]!.Errors.First().ErrorMessage
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Fechar"></button>
            </div>
        }

        <div class="form-group d-flex mt-2">
            <form action="/questoes/@Model.Questao.Id/adicionar-alternativa" method="post">
                <div class="mt-3">
                    <label class="form-label fs-5" asp-for="TextoAlternativa">Alternativa:</label>
                    <input class="form-control" id="inputTextoAlternativa" asp-for="TextoAlternativa" />
                    <span class="text-danger d-block mt-2" asp-validation-for="TextoAlternativa"></span>
                </div>
                <button type="submit" class="btn btn-primary align-self-end col">
                    <i class="bi bi-journal-plus"></i>
                    Adicionar Alternativa
                </button>
            </form>
        </div>

        <table class="table">
            <thead>
                <tr>
                    <th>Enunciado</th>
                    <th>Correta</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                @foreach (AlternativaQuestaoViewModel alternativa in Model.Alternativas)
                {
                    <tr>
                        <td>@alternativa.Texto</td>
                        <td>
                            <form asp-action="MarcarAlternativaCorreta" asp-route-id="@Model.Questao.Id" asp-route-idAlternativaCorreta="@alternativa.Id" method="post" style="display:inline;">
                                <input type="radio" name="alternativaCorreta" @(alternativa.EstaCorreta ? "checked" : "") onclick="this.form.submit();" />
                            </form>
                        </td>
                        <td>
                            <form asp-action="RemoverAlternativa" asp-route-id="@Model.Questao.Id" asp-route-idAlternativa="@alternativa.Id" method="post" style="display:inline;">
                                <button type="submit" class="btn btn-link text-danger p-0">
                                    Excluir
                                </button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>

        <div class="d-flex justify-content-center gap-5 mb-4">
            <form asp-action="Excluir" asp-route-id="@Model.Questao.Id" method="post">
                <button type="submit" class="btn btn-outline-danger rounded-3 px-2">Cancelar</button>
            </form>
            <form asp-action="FinalizarQuestao" asp-route-id="@Model.Questao.Id" method="post">
                <button type="submit" class="btn btn-primary rounded-3 px-2">
                    Finalizar Questão
                </button>
            </form>
        </div>
    </div>
</div>
@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}